package estoque00;

import java.sql.*;
import java.util.Scanner;

public class Comandos {
	
// TABLE PRODUTOS----------------------------------------------------------------------------------------------	
	// the INSERT SQL command. Inserts new product and his values
	public static String inserir() {
		String bom = "funfou";
		Connection con = Conexao.getConnection();
		String sql = "insert into Produtos(setor, modelo, tamanho, cor, preco, estoque) values"
				+ "(?, ?, ?, ?, ?, ?)";
		
		
		try {
		PreparedStatement st = con.prepareStatement(sql);
		st.setString(1, "Camisas");
		st.setString(2, "Polo Lacoste");
		st.setString(3, "GG");
		st.setString(4, "Vermelha");
		st.setFloat(5, 99);
		st.setInt(6, 0);
		
		st.executeUpdate();
		// close the statement and connection to free up espace
		st.close();
		con.close();
		
		System.out.print("DADOS INSERIDOS COM SUCESSO.");
		return bom;
	}catch (SQLException e) {
		e.printStackTrace();
		return null;
		}
		
	}
	// Delete SQL command. When the produts is not disponible ('estoque' = 0)
	public static String excluir() {
		String x = "";
		Connection con = Conexao.getConnection();
		String sql = "delete from produtos where estoque <= 0;";
		
		try {
			PreparedStatement st = con.prepareStatement(sql);
			st.executeUpdate();
			
			st.close();
			con.close();
			System.out.print(" EXCLUIDO COM SUCESSO");
			return x;
		} catch (SQLException e) {
			e.printStackTrace();
			return null;
			
		}
		
	}
	// UPDATE SQL command. The sales will decreased  quantity in 'estoque'
	public static String atualizar() {
		String x = "";
		Connection con = Conexao.getConnection();
		String sql = "UPDATE produtos INNER JOIN venda ON venda.idVenda = produtos.id "
				+ "SET produtos.estoque = estoque - venda.quantidade WHERE produtos.id = venda.idVenda;";
		try {
			PreparedStatement st = con.prepareStatement(sql);
			st.executeUpdate();
			
			st.close();
			con.close();
				
			System.out.print("ATUALIZADO COM SUCESSO");
			return x;
		} catch (SQLException e) {
			e.printStackTrace();
			return null;
		}
		
	}

	
}
